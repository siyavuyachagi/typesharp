# TypeSharp

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![npm version](https://img.shields.io/npm/v/@siyavuyachagi/typesharp.svg?label=Version)](https://www.npmjs.com/package/@siyavuyachagi/typesharp)
[![npm downloads](https://img.shields.io/npm/dm/@siyavuyachagi/typesharp.svg?label=Downloads)](https://www.npmjs.com/package/@siyavuyachagi/typesharp)
[![GitHub commits](https://img.shields.io/github/commit-activity/m/siyavuyachagi/typesharp?label=Commits)](https://github.com/siyavuyachagi/typesharp/commits/main)
[![GitHub last commit](https://img.shields.io/github/last-commit/siyavuyachagi/typesharp?label=Last+commit)](https://github.com/siyavuyachagi/typesharp/commits/main)
[![GitHub issues](https://img.shields.io/github/issues/siyavuyachagi/typesharp?label=Issues)](https://github.com/siyavuyachagi/typesharp/issues)
[![GitHub stars](https://img.shields.io/github/stars/siyavuyachagi/typesharp?label=Stars)](https://github.com/siyavuyachagi/typesharp/stargazers)
[![Sponsor](https://img.shields.io/badge/Sponsor-üíñ-ff69b4)](https://github.com/sponsors/siyavuyachagi)

Generate TypeScript types from C# models with ease! TypeSharp scans your ASP.NET Core projects and automatically generates TypeScript interfaces from your C# classes decorated with the `[TypeSharp]` attribute.

## Features

‚ú® **Automatic Type Generation** ‚Äì Convert C# models to TypeScript interfaces  
üéØ **Custom Attribute Targeting** ‚Äì Use `[TypeSharp]` or any custom attribute  
üîÑ **Nullable Support** ‚Äì `string?` ‚Üí `string | null`  
üì¶ **Collection Handling** ‚Äì Supports `List<T>`, `IEnumerable<T>`, arrays **and generic collections**  
üó∫Ô∏è **Dictionary Mapping** ‚Äì `Dictionary<K, V>` ‚Üí `Record<K, V>`  
üß¨ **Generic Types** ‚Äì Preserves generic type definitions like `Response<T>` ‚Üí `Response<T>`  
üß¨ **Inheritance** ‚Äì Preserves class inheritance using `extends`  
üèóÔ∏è **Computed Properties** ‚Äì Expression-bodied and block getter properties are included  
üé® **Naming Conventions** ‚Äì Convert property names (camel, pascal, snake, kebab)  
üìÅ **Flexible Output** ‚Äì Single file or multiple files  
üî¢ **Enum Support** ‚Äì Converts C# enums to TypeScript string enums  
üóÇÔ∏è **File Grouping** ‚Äì Preserves C# file organization (multiple classes per file stay together)  
üîó **Auto Imports** ‚Äì Automatically generates `import type` statements between output files  
üè¢ **Multi-Project** ‚Äì Scan multiple `.csproj` files in a single run

## How TypeSharp Compares

This is not an OpenApi-based tool !
| Feature | TypeSharp | NSwag | openapi-typescript | TypeGen |
| --------------------- | --------- | ----- | ------------------ | ------- |
| Direct C# parsing | ‚úÖ | ‚ùå | ‚ùå | ‚úÖ |
| Attribute targeting | ‚úÖ | ‚ö†Ô∏è | ‚ùå | ‚ö†Ô∏è |
| Non-API models | ‚úÖ | ‚ùå | ‚ùå | ‚úÖ |
| Generics preserved | ‚úÖ | ‚ö†Ô∏è | ‚ö†Ô∏è | ‚ö†Ô∏è |
| File grouping | ‚úÖ | ‚ùå | ‚ùå | ‚ùå |
| Naming control | ‚úÖ | ‚ö†Ô∏è | ‚ö†Ô∏è | ‚ùå |
| API client generation | ‚ùå | ‚úÖ | ‚ùå | ‚ùå |

For more [docs/why-typesharp](docs/why-typesharp.md)

## Installation

```bash
npm install -D @siyavuyachagi/typesharp
```

## Quick Start

### 1. Create an attribute to target

In your target project create the following attribute (`TypeSharp`)

```cs
namespace YourProject.Attribute
{
  [AttributeUsage(AttributeTargets.Class | AttributeTargets.Enum)]
  public class TypeSharpAttribute : Attribute { }
}
```

### 2. Decorate your C# models or DTOs

```csharp
[TypeSharp]
public class User
{
  public int Id { get; set; }
  public string? Name { get; set; }
  public string Email { get; set; }
  public List<UserRole> Roles { get; set; }
  public List<string> Permissions { get; set; }
  public DateTime CreatedAt { get; set; }
}

[TypeSharp]
public enum UserRole
{
  Admin,
  User,
  Guest
}

[TypeSharp]
public class ApiResponse<T>
{
  public bool Success { get; set; }
  public string? Message { get; set; }
  public T Data { get; set; }
  public List<string> Errors { get; set; }
}
```

### 3. Create a configuration file

In your frontend project run the following script

```bash
# Create TypeScript config
npx typesharp init

# ----- OR -------

# Create JSON config
npx typesharp init --format json

# Create TypeScript config (default)
npx typesharp init --format ts

# Create JavaScript config
npx typesharp init --format js
```

This creates `typesharp.config.json`:

```json
{
  "projectFiles": [
    "C:/Users/User/Desktop/MyApp/Api/Api.csproj",
    "C:/Users/User/Desktop/MyApp/Domain/Domain.csproj"
  ],
  "outputPath": "./app/types",
  "targetAnnotation": "TypeSharp",
  "singleOutputFile": false,
  "namingConvention": "camel"
}
```

### 4. Generate TypeScript types

```bash
npx typesharp

# ----- OR -------

npx typesharp generate
# or with custom config
npx typesharp generate --config ./custom-config.ts
```

Output (`app/types/user.ts`):

```typescript
/**
 * Auto-generated by TypeSharp
 * Generated at: 2024-12-12T10:30:00.000Z
 * Do not edit this file manually
 */

export interface User {
  id: number;
  name: string | null;
  email: string;
  roles: UserRole[];
  permissions: string[];
  createdAt: string;
}
```

Output (`app/types/user-role.ts`):

```ts
/**
 * Auto-generated by TypeSharp
 * Generated at: 2024-12-12T10:30:00.000Z
 * Do not edit this file manually
 */

export enum UserRole {
  Admin = "Admin",
  User = "User",
  Guest = "Guest",
}
```

Output (`app/types/api-response.ts`):

```ts
/**
 * Auto-generated by TypeSharp
 * Generated at: 2024-12-12T10:30:00.000Z
 * Do not edit this file manually
 */

export interface ApiResponse<T> {
  success: boolean;
  message: string | null;
  data: T;
  errors: string[];
}
```

For more advanced usage [docs/usage](docs/usage.md)

## Configuration

### 1. Configuration Options

| Option             | Type                                      | Default       | Description                                                   |
| ------------------ | ----------------------------------------- | ------------- | ------------------------------------------------------------- |
| `projectFiles`     | `string \| string[]`                      | _required_    | Full path(s) to your C# .csproj file(s)                       |
| `outputPath`       | `string`                                  | _required_    | Where to generate TypeScript files                            |
| `targetAnnotation` | `string`                                  | `'TypeSharp'` | C# attribute name to look for                                 |
| `singleOutputFile` | `boolean`                                 | `false`       | Generate one file or multiple files (see below)               |
| `namingConvention` | `string \| { dir: string, file: string }` | `'camel'`     | Property/file/dir naming: `kebab`, `camel`, `pascal`, `snake` |
| `fileSuffix`       | `string`                                  | _optional_    | Suffix appended to generated file names: `user-dto.ts`        |

### 2. Naming Convention

`namingConvention` accepts either a simple string that applies to everything, or a config object for separate control over directories and files:

```json
// Simple ‚Äî applies to both dirs and files
{ "namingConvention": "kebab" }

// Advanced ‚Äî separate control
{
  "namingConvention": {
    "dir": "kebab",
    "file": "camel"
  }
}
```

### 3. Output File Behavior

TypeSharp preserves your C# file organization. Here's how it works:

| C# File Structure                                          | `singleOutputFile: false`                        | `singleOutputFile: true`  |
| ---------------------------------------------------------- | ------------------------------------------------ | ------------------------- |
| **One class per file**<br>`User.cs` ‚Üí 1 class              | `user.ts` (1 interface)                          | All classes in `types.ts` |
| **Multiple classes per file**<br>`UserDtos.cs` ‚Üí 3 classes | `user-dtos.ts` (3 interfaces)                    | All classes in `types.ts` |
| **Mixed structure**<br>Various C# files                    | Each C# file ‚Üí 1 TS file<br>(preserves grouping) | All classes in `types.ts` |

**Example:**

```
C# Structure:                       TypeScript Output (singleOutputFile: false):
Backend/                           src/types/
‚îú‚îÄ‚îÄ DTOs/                         ‚îî‚îÄ‚îÄ DTOs/
‚îÇ   ‚îú‚îÄ‚îÄ UserDtos.cs               ‚îÇ   ‚îú‚îÄ‚îÄ user-dtos.ts      ‚Üê All 3 classes together
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ UserCreateDto         ‚îÇ   ‚îî‚îÄ‚îÄ product-dtos.ts   ‚Üê All 2 classes together
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ UserUpdateDto
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ UserResponseDto
‚îÇ   ‚îî‚îÄ‚îÄ ProductDtos.cs
‚îÇ       ‚îú‚îÄ‚îÄ ProductDto
‚îÇ       ‚îî‚îÄ‚îÄ ProductCreateDto
```

**This means if you organize related DTOs in one C# file, they'll stay together in the generated TypeScript file!** üéØ

### 4. Configuration File Formats

TypeSharp supports multiple configuration formats:

**JSON** (`typesharp.config.json`): (recommended)

```json
{
  "projectFiles": ["C:/Users/User/Desktop/MyApp/Domain/Domain.csproj"],
  "outputPath": "./src/types"
}
```

**TypeScript** (`typesharp.config.ts`):

```typescript
import { TypeSharpConfig } from "typesharp";

const config: TypeSharpConfig = {
  projectFiles: ["C:/Users/User/Desktop/MyApp/Domain/Domain.csproj"],
  outputPath: "./src/types",
};

export default config;
```

**JavaScript** (`typesharp.config.js`):

```javascript
module.exports = {
  projectFiles: ["C:/Users/User/Desktop/MyApp/Domain/Domain.csproj"],
  outputPath: "./src/types",
};
```

## Usage in package.json

Add TypeSharp to your build scripts:

```json
{
  "scripts": {
    "generate-types": "typesharp",
    "dev": "typesharp && nuxt dev",
    "build": "typesharp && nuxt build"
  }
}
```

## Advanced Examples

### 1. With Inheritance

**C#:**

```csharp
[TypeSharp]
public class BaseEntity
{
    public int Id { get; set; }
    public DateTime CreatedAt { get; set; }
}

[TypeSharp]
public class Product : BaseEntity
{
    public string Name { get; set; }
    public decimal Price { get; set; }
}
```

**Generated TypeScript:**

```typescript
export interface BaseEntity {
  id: number;
  createdAt: string;
}

export interface Product extends BaseEntity {
  name: string;
  price: number;
}
```

### 2. Computed Properties

TypeSharp includes expression-bodied and block getter properties in the generated output:

**C#:**

```csharp
[TypeSharp]
public class PollOptionUserLinkDto
{
    public int Id { get; set; }
    public int UserId { get; set; }
    public UserDto User { get; set; }

    // Expression-bodied
    public string? Avatar => User?.Avatar;

    // Block getter
    public string UserFirstName { get { return User.FirstName; } }

    // Init-only (Planned)
    // public string Slug { get; init; }
}
```

**Generated TypeScript:**

```typescript
export interface PollOptionUserLinkDto {
  id: number;
  userId: number;
  user: UserDto;
  avatar: string | null;
  userFirstName: string;
  slug: string;
}
```

### 3. Dictionary Types

**C#:**

```csharp
[TypeSharp]
public class PermissionMap
{
    public Dictionary<string, bool> Flags { get; set; }
    public IReadOnlyDictionary<string, List<string>> RolePermissions { get; set; }
}
```

**Generated TypeScript:**

```typescript
export interface PermissionMap {
  flags: Record<string, boolean>;
  rolePermissions: Record<string, string[]>;
}
```

### 4. Multi-Project

Scan multiple C# projects at once:

```json
{
  "projectFiles": [
    "C:/MyApp/Api/Api.csproj",
    "C:/MyApp/Domain/Domain.csproj",
    "C:/MyApp/Contracts/Contracts.csproj"
  ],
  "outputPath": "./src/types"
}
```

### 5. Single Output File

**Config:**

```typescript
const config: TypeSharpConfig = {
  projectFiles: "./Backend/Backend.csproj",
  outputPath: "./src/types",
  singleOutputFile: true,
};
```

All types will be generated in `src/types/types.ts`

### 6. Custom Naming Conventions

**Config:**

```typescript
const config: TypeSharpConfig = {
  projectFiles: "./Backend/Backend.csproj",
  outputPath: "./src/types",
  namingConvention: {
    dir: "kebab", // ./src/types/my-feature/
    file: "camel", // myFeatureDto.ts
  },
};
```

## Type Mappings

### Primitives & Common Types

| C# Type                                             | TypeScript Type |
| --------------------------------------------------- | --------------- |
| `bool`                                              | `boolean`       |
| `byte`, `decimal`, `double`, `float`, `int`, `long` | `number`        |
| `DateTime`, `DateOnly`, `TimeOnly`                  | `string`        |
| `Guid`, `string`                                    | `string`        |
| `object`                                            | `any`           |

### Collections

| C# Type                                                              | TypeScript Type |
| -------------------------------------------------------------------- | --------------- |
| `List<T>`, `ICollection<T>`, `IEnumerable<T>`, `T[]`                 | `T[]`           |
| `Dictionary<K, V>`, `IDictionary<K, V>`, `IReadOnlyDictionary<K, V>` | `Record<K, V>`  |

### ASP.NET / File Types

| C# Type                                | TypeScript Type |
| -------------------------------------- | --------------- |
| `IFormFile`, `FormFile`                | `File`          |
| `IFormFileCollection`                  | `File[]`        |
| `FileStream`, `MemoryStream`, `Stream` | `Blob`          |

## Programmatic Usage

You can also use TypeSharp programmatically:

```typescript
import { generate } from "typesharp";

async function generateTypes() {
  await generate("./path/to/config.ts");
}

generateTypes();
```

## Requirements

- Node.js >= 14
- TypeScript >= 4.5 (if using TypeScript config)

## License

MIT ¬© Siyavuya Chagi

## Author

**Siyavuya Chagi (CeeJay)**

- GitHub: [@siyavuyachagi](https://github.com/siyavuyachagi)
- Email: syavuya08@gmail.com

---

Built with ‚ù§Ô∏è in South Africa üáøüá¶
